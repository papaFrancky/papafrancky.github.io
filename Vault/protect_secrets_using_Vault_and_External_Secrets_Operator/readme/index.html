
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../kind_vault_external_secrets_operator/README.2/">
      
      
      
      <link rel="icon" href="../../../images/poo.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Protect the secrets of your application using HashiCorp Vault and the External Secrets Operator (ESO) - Papa Francky's HowTos</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13.274 9.537v-.001l-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074ZM4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75Z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.484 4.484 0 0 1-.563-1.191 3.835 3.835 0 0 1-.05-2.063 4.647 4.647 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .748.748 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.425 2.425 0 0 1-.507-.441 3.075 3.075 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19a.884.884 0 0 1 .01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.737 3.737 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353V.75Z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343h-.001a8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746Zm1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275ZM6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L6.94 8 4.97 6.03a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018Z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.249 1.249 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429Zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006a.036.036 0 0 0-.004-.009l-.006-.006-.008-.001c-.003 0-.006.002-.009.004Z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.488 3.488 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327c0 .1-.009.197-.025.292.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5c0 .409-.049.806-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A4.997 4.997 0 0 1 8 16a4.997 4.997 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5.036 5.036 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.677 1.677 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06Zm.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.172.172 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173Z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5Zm4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5ZM2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0Z"/></svg>');}</style>


  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 13h-4v4h-2v-4H7v-2h4V7h2v4h4m-5-9A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#protect-the-secrets-of-your-application-using-hashicorp-vault-and-the-external-secrets-operator-eso" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Papa Francky&#39;s HowTos" class="md-header__button md-logo" aria-label="Papa Francky's HowTos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M268.9.9c-5.5-.7-11 1.4-14.5 5.7s-4.6 10.1-2.8 15.4c2.8 8.2 4.3 16.9 4.3 26.1 0 44.1-35.7 79.9-79.8 80H160c-35.3 0-64 28.7-64 64 0 19.1 8.4 36.3 21.7 48H104c-39.8 0-72 32.2-72 72 0 23.2 11 43.8 28 57-34.1 5.7-60 35.3-60 71 0 39.8 32.2 72 72 72h368c39.8 0 72-32.2 72-72 0-35.7-25.9-65.3-60-71 17-13.2 28-33.8 28-57 0-39.8-32.2-72-72-72h-13.7c13.3-11.7 21.7-28.9 21.7-48 0-35.3-28.7-64-64-64h-5.5c3.5-10 5.5-20.8 5.5-32 0-48.6-36.2-88.8-83.1-95.1zM192 256a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm96 32a32 32 0 1 1 64 0 32 32 0 1 1-64 0zm64 108.3c0 2.4-.7 4.8-2.2 6.7-8.2 10.5-39.5 45-93.8 45s-85.6-34.6-93.8-45c-1.5-1.9-2.2-4.3-2.2-6.7 0-6.8 5.5-12.3 12.3-12.3h167.4c6.8 0 12.3 5.5 12.3 12.3z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Papa Francky's HowTos
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Protect the secrets of your application using HashiCorp Vault and the External Secrets Operator (ESO)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Papa Francky&#39;s HowTos" class="md-nav__button md-logo" aria-label="Papa Francky's HowTos" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M268.9.9c-5.5-.7-11 1.4-14.5 5.7s-4.6 10.1-2.8 15.4c2.8 8.2 4.3 16.9 4.3 26.1 0 44.1-35.7 79.9-79.8 80H160c-35.3 0-64 28.7-64 64 0 19.1 8.4 36.3 21.7 48H104c-39.8 0-72 32.2-72 72 0 23.2 11 43.8 28 57-34.1 5.7-60 35.3-60 71 0 39.8 32.2 72 72 72h368c39.8 0 72-32.2 72-72 0-35.7-25.9-65.3-60-71 17-13.2 28-33.8 28-57 0-39.8-32.2-72-72-72h-13.7c13.3-11.7 21.7-28.9 21.7-48 0-35.3-28.7-64-64-64h-5.5c3.5-10 5.5-20.8 5.5-32 0-48.6-36.2-88.8-83.1-95.1zM192 256a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm96 32a32 32 0 1 1 64 0 32 32 0 1 1-64 0zm64 108.3c0 2.4-.7 4.8-2.2 6.7-8.2 10.5-39.5 45-93.8 45s-85.6-34.6-93.8-45c-1.5-1.9-2.2-4.3-2.2-6.7 0-6.8 5.5-12.3 12.3-12.3h167.4c6.8 0 12.3 5.5 12.3 12.3z"/></svg>

    </a>
    Papa Francky's HowTos
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MkDocs cheatsheet
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    000 setup
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            000 setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../000_setup/Command_line_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command Line Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../000_setup/Kubernetes_en_local/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes en local
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Docker
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Docker/build_pull_image_on_dockerhub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Créer et publier une image sur DockerHub
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FluxCD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            FluxCD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FluxCD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FluxCD/FlucCD_arborescence_par_produit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FluxCD - Proposition de nouvelle organisation des manifests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FluxCD/FluxCD_demonstration_par_l_exemple/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FluxCD - Démonstration par l'exemple
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GKE
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            GKE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    cluster GKE SSL load balancer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            cluster GKE SSL load balancer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../GKE/cluster_GKE_SSL_load-balancer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster GKE en mode autopilot, load-balancer HTTPS et application 'stateless'
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    cluster GKE Wordpress CloudSQL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            cluster GKE Wordpress CloudSQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../GKE/cluster_GKE_Wordpress_CloudSQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploy WordPress on GKE with Persistent Disk and Cloud SQL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dkt upgrade cluster gke
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Dkt upgrade cluster gke
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../GKE/dkt_upgrade_cluster_gke/readme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mise à jour des clusters Kubernetes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    terraform GKE cluster
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            terraform GKE cluster
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../GKE/terraform_GKE_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Minikube
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Minikube
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Minikube/minikube_nginx_controller_macos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minikube et l'ingress Nginx sur macOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Prometheus on minikube from scratch
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Prometheus on minikube from scratch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Minikube/prometheus_on_minikube_from_scratch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prometheus on MiniKube from scratch
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Prometheus and Grafana
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Prometheus and Grafana
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Prometheus_and_Grafana/kube-prometheus-stack_managed_with_fluxcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    'kube-prometheus-stack' managed with FluxCD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Prometheus_and_Grafana/prometheus_grafana_on_k8s/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prometheus &amp; Grafana on Kubernetes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vault
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Vault
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cluster minikube vault with raft storage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            Cluster minikube vault with raft storage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cluster_minikube_vault_with_raft_storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster [kind|minikube] - HashiCorp Vault with Raft integrated storage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Helm vault auto unseal
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Helm vault auto unseal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../helm_vault_auto-unseal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auto-unsealed Vault Helm deployment managed with FluxCD
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
        
          
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    kind helm vault auto unseal ESO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            kind helm vault auto unseal ESO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kind_helm_vault_auto-unseal_ESO/kind_vault_auto-unsealed_eso_fluxcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Déploiement de Vault (auto-unsealed) et ESO via FluxCD sur un cluster KinD
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4" >
        
          
          <label class="md-nav__link" for="__nav_8_4" id="__nav_8_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kind vault external secrets operator
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4">
            <span class="md-nav__icon md-icon"></span>
            Kind vault external secrets operator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kind_vault_external_secrets_operator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kind - Vault - External-secrets operator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kind_vault_external_secrets_operator/README.2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kind - Vault - External-secrets operator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_5" checked>
        
          
          <label class="md-nav__link" for="__nav_8_5" id="__nav_8_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    protect secrets using Vault and External Secrets Operator
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_5">
            <span class="md-nav__icon md-icon"></span>
            protect secrets using Vault and External Secrets Operator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Protect the secrets of your application using HashiCorp Vault and the External Secrets Operator (ESO)
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Protect the secrets of your application using HashiCorp Vault and the External Secrets Operator (ESO)
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Abstract">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docs-de-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Docs de référence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-requis-kubernetes-cluster-local" class="md-nav__link">
    <span class="md-ellipsis">
      Pré-requis Kubernetes (cluster local)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vault" class="md-nav__link">
    <span class="md-ellipsis">
      Vault
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vault">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploiement-manuel-de-vault-en-mode-auto-unseal" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement manuel de Vault en mode auto-unseal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-de-vault-en-mode-auto-unseal-depuis-le-helm-chart-officiel-et-pilote-par-fluxcd" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de Vault en mode auto-unseal depuis le Helm Chart officiel et piloté par FluxCD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Déploiement de Vault en mode auto-unseal depuis le Helm Chart officiel et piloté par FluxCD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alerting-discord" class="md-nav__link">
    <span class="md-ellipsis">
      alerting Discord
    </span>
  </a>
  
    <nav class="md-nav" aria-label="alerting Discord">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creation-du-salon-prive-sur-le-client-discord" class="md-nav__link">
    <span class="md-ellipsis">
      création du salon privé sur le client Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-place-le-webhook-du-salon-discord-dans-un-secret-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      on place le webhook du salon discord dans un secret kubernetes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definition-de-lalert-provider-discord" class="md-nav__link">
    <span class="md-ellipsis">
      définition de l'alert-provider Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-des-alertes-discord" class="md-nav__link">
    <span class="md-ellipsis">
      configuration des alertes Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#poussons-les-manifests-sur-le-repo-central-pour-que-fluxcd-les-gere" class="md-nav__link">
    <span class="md-ellipsis">
      Poussons les manifests sur le repo central pour que FluxCD les gère :
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestion-du-repo-helm" class="md-nav__link">
    <span class="md-ellipsis">
      Gestion du repo Helm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-de-vault-helm-release" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de Vault (helm release)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploiement-de-lexternal-secrets-operator-eso" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de l'External Secrets Operator (ESO)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Déploiement de l'External Secrets Operator (ESO)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clonage-en-local-du-repository-git-de-fluxcd" class="md-nav__link">
    <span class="md-ellipsis">
      Clonage en local du repository Git de FluxCD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commencons-par-creer-le-namespace-dedie-a-eso" class="md-nav__link">
    <span class="md-ellipsis">
      Commençons par créer le namespace dédié à ESO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definissons-ensuite-le-helm-repository-pour-fluxcd" class="md-nav__link">
    <span class="md-ellipsis">
      Définissons ensuite le Helm repository pour FluxCD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-de-loperateur-external-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de l'opérateur External Secrets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mise-a-jour-du-repo-git-distant-pour-prise-en-compte-par-fluxcd" class="md-nav__link">
    <span class="md-ellipsis">
      Mise à jour du repo Git distant pour prise en compte par FluxCD
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-de-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration de Vault
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration de Vault">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#activation-de-lauthentification-kubernetes-sur-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Activation de l'authentification Kubernetes sur Vault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-of-the-kubernetes-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration of the Kubernetes authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploiement-de-lapplication-silly-webapp" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de l'application 'silly-webapp'
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Déploiement de l'application 'silly-webapp'">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operations-sur-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Opérations sur Vault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-du-helm-chart-pour-lapplication-silly-webapp" class="md-nav__link">
    <span class="md-ellipsis">
      Création du Helm Chart pour l'application 'silly-webapp'
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Création du Helm Chart pour l'application 'silly-webapp'">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lapplication-en-question" class="md-nav__link">
    <span class="md-ellipsis">
      L'application en question
    </span>
  </a>
  
    <nav class="md-nav" aria-label="L'application en question">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creation-manuelle" class="md-nav__link">
    <span class="md-ellipsis">
      Création 'manuelle'
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packaging-de-lapplication-avec-helm" class="md-nav__link">
    <span class="md-ellipsis">
      Packaging de l'application avec Helm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creation-dun-repository-de-helm-charts-avec-github-et-github-actions" class="md-nav__link">
    <span class="md-ellipsis">
      Création d'un repository de Helm Charts avec GitHub et GitHub Actions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Création d'un repository de Helm Charts avec GitHub et GitHub Actions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creation-dun-github-repository-dedie-a-nos-helm-harts" class="md-nav__link">
    <span class="md-ellipsis">
      Création d'un GitHub Repository dédié à nos Helm harts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#la-github-action" class="md-nav__link">
    <span class="md-ellipsis">
      La GitHub Action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copie-de-notre-helm-chart-silly-webapp-dans-notre-helm-repo" class="md-nav__link">
    <span class="md-ellipsis">
      Copie de notre Helm Chart 'silly-webapp' dans notre Helm repo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilisation-de-notre-helm-repo" class="md-nav__link">
    <span class="md-ellipsis">
      Utilisation de notre Helm repo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestion-de-silly-webapp-par-fluxcd" class="md-nav__link">
    <span class="md-ellipsis">
      Gestion de 'silly-webapp' par FluxCD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gestion de 'silly-webapp' par FluxCD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alerting-discord_1" class="md-nav__link">
    <span class="md-ellipsis">
      alerting Discord
    </span>
  </a>
  
    <nav class="md-nav" aria-label="alerting Discord">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creation-du-salon-prive-sur-le-client-discord_1" class="md-nav__link">
    <span class="md-ellipsis">
      création du salon privé sur le client Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-place-le-webhook-du-salon-discord-dans-un-secret-kubernetes_1" class="md-nav__link">
    <span class="md-ellipsis">
      on place le webhook du salon discord dans un secret kubernetes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definition-de-lalert-provider-discord_1" class="md-nav__link">
    <span class="md-ellipsis">
      définition de l'alert-provider Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-des-alertes-discord_1" class="md-nav__link">
    <span class="md-ellipsis">
      configuration des alertes Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#poussons-les-manifests-sur-le-repo-central-pour-que-fluxcd-les-gere_1" class="md-nav__link">
    <span class="md-ellipsis">
      Poussons les manifests sur le repo central pour que FluxCD les gère :
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestion-du-repo-helm_1" class="md-nav__link">
    <span class="md-ellipsis">
      Gestion du repo Helm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-de-silly-webapp-helm-release" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de silly-webapp (helm release)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#protection-de-webhook-utilise-pour-la-notification-discord" class="md-nav__link">
    <span class="md-ellipsis">
      Protection de webhook utilisé pour la notification Discord
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Protection de webhook utilisé pour la notification Discord">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ajout-du-webhook-dans-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Ajout du webhook dans Vault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modification-de-la-vault-policy-pour-silly-webapp" class="md-nav__link">
    <span class="md-ellipsis">
      Modification de la Vault policy pour silly-webapp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Abstract">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docs-de-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Docs de référence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-requis-kubernetes-cluster-local" class="md-nav__link">
    <span class="md-ellipsis">
      Pré-requis Kubernetes (cluster local)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vault" class="md-nav__link">
    <span class="md-ellipsis">
      Vault
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vault">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploiement-manuel-de-vault-en-mode-auto-unseal" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement manuel de Vault en mode auto-unseal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-de-vault-en-mode-auto-unseal-depuis-le-helm-chart-officiel-et-pilote-par-fluxcd" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de Vault en mode auto-unseal depuis le Helm Chart officiel et piloté par FluxCD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Déploiement de Vault en mode auto-unseal depuis le Helm Chart officiel et piloté par FluxCD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alerting-discord" class="md-nav__link">
    <span class="md-ellipsis">
      alerting Discord
    </span>
  </a>
  
    <nav class="md-nav" aria-label="alerting Discord">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creation-du-salon-prive-sur-le-client-discord" class="md-nav__link">
    <span class="md-ellipsis">
      création du salon privé sur le client Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-place-le-webhook-du-salon-discord-dans-un-secret-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      on place le webhook du salon discord dans un secret kubernetes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definition-de-lalert-provider-discord" class="md-nav__link">
    <span class="md-ellipsis">
      définition de l'alert-provider Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-des-alertes-discord" class="md-nav__link">
    <span class="md-ellipsis">
      configuration des alertes Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#poussons-les-manifests-sur-le-repo-central-pour-que-fluxcd-les-gere" class="md-nav__link">
    <span class="md-ellipsis">
      Poussons les manifests sur le repo central pour que FluxCD les gère :
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestion-du-repo-helm" class="md-nav__link">
    <span class="md-ellipsis">
      Gestion du repo Helm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-de-vault-helm-release" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de Vault (helm release)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploiement-de-lexternal-secrets-operator-eso" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de l'External Secrets Operator (ESO)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Déploiement de l'External Secrets Operator (ESO)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clonage-en-local-du-repository-git-de-fluxcd" class="md-nav__link">
    <span class="md-ellipsis">
      Clonage en local du repository Git de FluxCD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commencons-par-creer-le-namespace-dedie-a-eso" class="md-nav__link">
    <span class="md-ellipsis">
      Commençons par créer le namespace dédié à ESO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definissons-ensuite-le-helm-repository-pour-fluxcd" class="md-nav__link">
    <span class="md-ellipsis">
      Définissons ensuite le Helm repository pour FluxCD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-de-loperateur-external-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de l'opérateur External Secrets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mise-a-jour-du-repo-git-distant-pour-prise-en-compte-par-fluxcd" class="md-nav__link">
    <span class="md-ellipsis">
      Mise à jour du repo Git distant pour prise en compte par FluxCD
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-de-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration de Vault
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration de Vault">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#activation-de-lauthentification-kubernetes-sur-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Activation de l'authentification Kubernetes sur Vault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-of-the-kubernetes-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration of the Kubernetes authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploiement-de-lapplication-silly-webapp" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de l'application 'silly-webapp'
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Déploiement de l'application 'silly-webapp'">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operations-sur-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Opérations sur Vault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-du-helm-chart-pour-lapplication-silly-webapp" class="md-nav__link">
    <span class="md-ellipsis">
      Création du Helm Chart pour l'application 'silly-webapp'
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Création du Helm Chart pour l'application 'silly-webapp'">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lapplication-en-question" class="md-nav__link">
    <span class="md-ellipsis">
      L'application en question
    </span>
  </a>
  
    <nav class="md-nav" aria-label="L'application en question">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creation-manuelle" class="md-nav__link">
    <span class="md-ellipsis">
      Création 'manuelle'
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packaging-de-lapplication-avec-helm" class="md-nav__link">
    <span class="md-ellipsis">
      Packaging de l'application avec Helm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creation-dun-repository-de-helm-charts-avec-github-et-github-actions" class="md-nav__link">
    <span class="md-ellipsis">
      Création d'un repository de Helm Charts avec GitHub et GitHub Actions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Création d'un repository de Helm Charts avec GitHub et GitHub Actions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creation-dun-github-repository-dedie-a-nos-helm-harts" class="md-nav__link">
    <span class="md-ellipsis">
      Création d'un GitHub Repository dédié à nos Helm harts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#la-github-action" class="md-nav__link">
    <span class="md-ellipsis">
      La GitHub Action
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copie-de-notre-helm-chart-silly-webapp-dans-notre-helm-repo" class="md-nav__link">
    <span class="md-ellipsis">
      Copie de notre Helm Chart 'silly-webapp' dans notre Helm repo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilisation-de-notre-helm-repo" class="md-nav__link">
    <span class="md-ellipsis">
      Utilisation de notre Helm repo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestion-de-silly-webapp-par-fluxcd" class="md-nav__link">
    <span class="md-ellipsis">
      Gestion de 'silly-webapp' par FluxCD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gestion de 'silly-webapp' par FluxCD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alerting-discord_1" class="md-nav__link">
    <span class="md-ellipsis">
      alerting Discord
    </span>
  </a>
  
    <nav class="md-nav" aria-label="alerting Discord">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creation-du-salon-prive-sur-le-client-discord_1" class="md-nav__link">
    <span class="md-ellipsis">
      création du salon privé sur le client Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-place-le-webhook-du-salon-discord-dans-un-secret-kubernetes_1" class="md-nav__link">
    <span class="md-ellipsis">
      on place le webhook du salon discord dans un secret kubernetes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definition-de-lalert-provider-discord_1" class="md-nav__link">
    <span class="md-ellipsis">
      définition de l'alert-provider Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-des-alertes-discord_1" class="md-nav__link">
    <span class="md-ellipsis">
      configuration des alertes Discord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#poussons-les-manifests-sur-le-repo-central-pour-que-fluxcd-les-gere_1" class="md-nav__link">
    <span class="md-ellipsis">
      Poussons les manifests sur le repo central pour que FluxCD les gère :
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestion-du-repo-helm_1" class="md-nav__link">
    <span class="md-ellipsis">
      Gestion du repo Helm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-de-silly-webapp-helm-release" class="md-nav__link">
    <span class="md-ellipsis">
      Déploiement de silly-webapp (helm release)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#protection-de-webhook-utilise-pour-la-notification-discord" class="md-nav__link">
    <span class="md-ellipsis">
      Protection de webhook utilisé pour la notification Discord
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Protection de webhook utilisé pour la notification Discord">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ajout-du-webhook-dans-vault" class="md-nav__link">
    <span class="md-ellipsis">
      Ajout du webhook dans Vault
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modification-de-la-vault-policy-pour-silly-webapp" class="md-nav__link">
    <span class="md-ellipsis">
      Modification de la Vault policy pour silly-webapp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="protect-the-secrets-of-your-application-using-hashicorp-vault-and-the-external-secrets-operator-eso">Protect the secrets of your application using HashiCorp Vault and the External Secrets Operator (ESO)</h1>
<h2 id="abstract">Abstract</h2>
<p>Notre cluster Kubernetes est opérationnel, avec FluxCD qui gère notamment des repos et des charts Helm.
Nous avons également un service Vault initialisé et descellé.</p>
<p>Nous allons déployer via Flux et à partir de son Helm Chart l'opérateur External Secrets.</p>
<p>Ensuite nous appliquerons la protection des secrets avec Vault via ESO sur une application (MySQL).</p>
<h3 id="docs-de-reference">Docs de référence</h3>
<ul>
<li>https://external-secrets.io/latest/introduction/getting-started/</li>
<li>https://external-secrets.io/latest/provider/hashicorp-vault/</li>
<li>https://github.com/jeffsanicola/vault-policy-guide?tab=readme-ov-file#kv-policies</li>
<li>https://external-secrets.io/latest/guides/common-k8s-secret-types/</li>
<li>https://external-secrets.io/latest/guides/templating/</li>
<li>https://external-secrets.io/latest/provider/hashicorp-vault/#kubernetes-authentication</li>
<li>https://support.hashicorp.com/hc/en-us/articles/4404389946387-Kubernetes-auth-method-Permission-Denied-error</li>
<li>
<p>https://external-secrets.io/main/guides/templating/#helm</p>
</li>
<li>
<p>https://medium.com/@stefanprodan/automate-helm-chart-repository-publishing-with-github-actions-and-pages-8a374ce24cf4</p>
</li>
<li>https://github.com/stefanprodan/helm-gh-pages</li>
</ul>
<h3 id="pre-requis-kubernetes-cluster-local">Pré-requis Kubernetes (cluster local)</h3>
<p>Avoir suivi la partie : 'Auto-unsealed Vault Helm deployment managed with FluxCD'. Nous devrions donc déjà avoir à notre disposition :
- un cluster Kind opérationnel, 
- FluxCD déployé,
- Helm installé,
- kubectl installé,
- HashiCorp Vault déployé depuis le Helm Chart officiel en mode auto-unseal via FluxCD.</p>
<p>Commençons par déployer l'External Secrets Operator (ESO)</p>
<h2 id="vault">Vault</h2>
<h3 id="deploiement-manuel-de-vault-en-mode-auto-unseal">Déploiement manuel de Vault en mode auto-unseal</h3>
<div class="language-text highlight"><pre><span></span><code>helm install vault hashicorp/vault -f values.yml --dry-run
kubens vault
kubectl get all

kubectl logs vault-0


kubectl exec -it vault-0 -- vault status
</code></pre></div>
<h3 id="deploiement-de-vault-en-mode-auto-unseal-depuis-le-helm-chart-officiel-et-pilote-par-fluxcd">Déploiement de Vault en mode auto-unseal depuis le Helm Chart officiel et piloté par FluxCD</h3>
<h4 id="alerting-discord">alerting Discord</h4>
<h5 id="creation-du-salon-prive-sur-le-client-discord">création du salon privé sur le client Discord</h5>
<p>Création d'un nouveau salon (privé) : 
  - nom : vault-development
  - webhook :
    - nom : FluxCD
    - URL : https://discord.com/api/webhooks/1213494413511237642/7gRzmfYCwDqWwI2D-1jfLZCNvDBotoe_rY2sson57G1Ya40-EtEMWAZy9FsxmjCZTJ4C</p>
<h5 id="on-place-le-webhook-du-salon-discord-dans-un-secret-kubernetes">on place le webhook du salon discord dans un secret kubernetes</h5>
<div class="language-text highlight"><pre><span></span><code>DISCORD_WEBHOOK=&quot;https://discord.com/api/webhooks/1213494413511237642/7gRzmfYCwDqWwI2D-1jfLZCNvDBotoe_rY2sson57G1Ya40-EtEMWAZy9FsxmjCZTJ4C&quot;
kubectl -n vault create secret generic discord-vault-development-webhook --from-literal=address=${DISCORD_WEBHOOK} --dry-run=client -o yaml &gt; products/vault/discord-vault-development-webhook.secret.yaml
</code></pre></div>
<h5 id="definition-de-lalert-provider-discord">définition de l'alert-provider Discord</h5>
<div class="language-text highlight"><pre><span></span><code>flux create alert-provider discord \
  --type=discord \
  --secret-ref=discord-webhook \
  --channel=vault-development \
  --username=FluxCD \
  --namespace=vault \
  --export &gt; products/vault/notification-provider.yaml
</code></pre></div>
<h5 id="configuration-des-alertes-discord">configuration des alertes Discord</h5>
<div class="language-text highlight"><pre><span></span><code>flux create alert discord \
  --event-severity=info \
  --event-source=&#39;GitRepository/*,Kustomization/*,ImageRepository/*,ImagePolicy/*,HelmRepository/*,HelmRelease/*&#39; \
  --provider-ref=discord \
  --namespace=vault \
  --export &gt; products/vault/notification-alert.yaml
</code></pre></div>
<h5 id="poussons-les-manifests-sur-le-repo-central-pour-que-fluxcd-les-gere">Poussons les manifests sur le repo central pour que FluxCD les gère :</h5>
<div class="language-text highlight"><pre><span></span><code>git add .
git commit -m &#39;feat: configuring discord alerting for vault.&#39;
git push

flux reconcile kustomization flux-system --with-source
flux events -w
</code></pre></div>
<h4 id="gestion-du-repo-helm">Gestion du repo Helm</h4>
<div class="language-text highlight"><pre><span></span><code>flux create source helm hashicorp \
  --url=https://helm.releases.hashicorp.com \
  --namespace=vault \
  --interval=1m \
  --export &gt; products/vault/helm-repository.yml
</code></pre></div>
<h4 id="deploiement-de-vault-helm-release">Déploiement de Vault (helm release)</h4>
<p>Recopier le fichier 'values.yaml' en 'custom-values.txt' (FluxCD ne gère que les manifests en YAML)</p>
<div class="language-text highlight"><pre><span></span><code>flux create helmrelease vault \
  --source=HelmRepository/hashicorp \
  --chart=vault \
  --values=products/vault/custom-values.txt \
  --namespace=vault \
  --export &gt; products/vault/helm-release.yaml

git status
  # Sur la branche main
  # Votre branche est à jour avec &#39;origin/main&#39;.
  # 
  # Fichiers non suivis:
  #   (utilisez &quot;git add &lt;fichier&gt;...&quot; pour inclure dans ce qui sera validé)
  #     products/vault/custom-values.txt
  #     products/vault/helm-release.yaml
  #     products/vault/helm-repository.yml

git add .
git commit -m &#39;feat: managing vault helm deployment.&#39;
git push

kubectl get all
  # NAME          READY   STATUS    RESTARTS   AGE
  # pod/vault-0   1/1     Running   0          17s
  # 
  # NAME                     TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)             AGE
  # service/vault            ClusterIP   10.96.102.150   &lt;none&gt;        8200/TCP,8201/TCP   17s
  # service/vault-internal   ClusterIP   None            &lt;none&gt;        8200/TCP,8201/TCP   17s
  # 
  # NAME                     READY   AGE
  # statefulset.apps/vault   1/1     17s

kubectl exec -it vault-0 -- vault status
  # Key                      Value
  # ---                      -----
  # Recovery Seal Type       shamir
  # Initialized              true
  # Sealed                   false
  # Total Recovery Shares    5
  # Threshold                3
  # Version                  1.15.2
  # Build Date               2023-11-06T11:33:28Z
  # Storage Type             file
  # Cluster Name             vault-cluster-6fa0df73
  # Cluster ID               b26de2f1-d9e7-8225-ad55-f114b37eeffb
  # HA Enabled               false
</code></pre></div>
<p>-&gt; C'est GOOD !!!
Note : pas besoin d'initialiser notre Vault car la config a été récupérée depuis le volume du statefulset créé préalablement.</p>
<h2 id="deploiement-de-lexternal-secrets-operator-eso">Déploiement de l'External Secrets Operator (ESO)</h2>
<h3 id="clonage-en-local-du-repository-git-de-fluxcd">Clonage en local du repository Git de FluxCD</h3>
<p>Nous devons ajouter les manifests dans le repo Git piloté par FluxCD.
Pour identifier ce dernier : </p>
<div class="language-text highlight"><pre><span></span><code>kubectl get gitrepository -n flux-system -&gt; https://github.com/papaFrancky/kubernetes-development.git
</code></pre></div>
<p>Mettons à jour la copie locale de ce repo : </p>
<div class="language-text highlight"><pre><span></span><code>cd ~/code/github/kubernetes-development
git pull
mkdir -p products/external-secrets
</code></pre></div>
<h3 id="commencons-par-creer-le-namespace-dedie-a-eso">Commençons par créer le namespace dédié à ESO</h3>
<div class="language-text highlight"><pre><span></span><code>kubectl create ns external-secrets --dry-run=client -o yaml | \
  grep -vE &quot;creationTimestamp:|^spec:|^status:&quot; &gt; products/external-secrets/namespace.yaml
kubectl apply -f products/external-secrets/namespace.yaml
</code></pre></div>
<h3 id="definissons-ensuite-le-helm-repository-pour-fluxcd">Définissons ensuite le Helm repository pour FluxCD</h3>
<div class="language-text highlight"><pre><span></span><code>flux create source helm external-secrets \
  --url=https://charts.external-secrets.io \
  --namespace=external-secrets \
  --interval=1m \
  --export &gt; products/external-secrets/helm-repository.yml
</code></pre></div>
<h3 id="deploiement-de-loperateur-external-secrets">Déploiement de l'opérateur External Secrets</h3>
<div class="language-text highlight"><pre><span></span><code>flux create helmrelease vault \
  --source=HelmRepository/external-secrets \
  --chart=external-secrets \
  --namespace=external-secrets \
  --export &gt; products/external-secrets/helm-release.yaml
</code></pre></div>
<h3 id="mise-a-jour-du-repo-git-distant-pour-prise-en-compte-par-fluxcd">Mise à jour du repo Git distant pour prise en compte par FluxCD</h3>
<div class="language-text highlight"><pre><span></span><code>git add .
git commit -m &#39;feat: installing External Secrets Operator (ESO.)&#39;
git push

flux reconcile kustomization flux-system --with-source
flux events -w

kubectl -n external-secrets get helmrepo,helmrelease

  # NAME                                                       URL                                  AGE     READY   STATUS
  # helmrepository.source.toolkit.fluxcd.io/external-secrets   https://charts.external-secrets.io   9m27s   True    stored artifact:       # revision &#39;sha256:35986103ade32186cf3d151ce19bae8939cfcbf7f64011cf5c5678ad2c8df860&#39;
  # 
  # NAME                                       AGE     READY   STATUS
  # helmrelease.helm.toolkit.fluxcd.io/vault   9m27s   True    Helm install succeeded for release external-secrets/vault.v1 with chart external-secrets@0.9.13
</code></pre></div>
<h2 id="configuration-de-vault">Configuration de Vault</h2>
<p>Dans la partie 'helm_vault_auto-unseal', nous avons décrit l'installation de Vault en mode descellé à partir d'un Helm Chart et piloté par FluxCD.</p>
<p>Lors de l'initialisation de Vault, nous avions récupéré le 'root token' dont nous aurons besoin pour la suite des opérations :</p>
<div class="language-text highlight"><pre><span></span><code>Initial Root Token: hvs.G145zNl012ApNOap3sn2zhIG
</code></pre></div>
<h3 id="activation-de-lauthentification-kubernetes-sur-vault">Activation de l'authentification Kubernetes sur Vault</h3>
<div class="language-text highlight"><pre><span></span><code>kubectl -n vault exec -it vault-0 -- sh    # ouverture d&#39;une session shell sur le pod vault-0
vault login hvs.G145zNl012ApNOap3sn2zhIG   # login à Vault avec le token root

vault auth enable kubernetes
vault auth list
exit
</code></pre></div>
<h3 id="configuration-of-the-kubernetes-authentication">Configuration of the Kubernetes authentication</h3>
<div class="language-text highlight"><pre><span></span><code># source: https://developer.hashicorp.com/vault/docs/auth/kubernetes#kubernetes-auth-method
#
#   Use local service account token as the reviewer JWT
#   
#   When running Vault in a Kubernetes pod the recommended option is to use the pod&#39;s local service account token.
#   Vault will periodically re-read the file to support short-lived tokens. To use the local token and CA certificate,
#   omit token_reviewer_jwt and kubernetes_ca_cert when configuring the auth method. Vault will attempt to load them
#   from token and ca.crt respectively inside the default mount folder /var/run/secrets/kubernetes.io/serviceaccount/.


kubectl -n vault exec -it vault-0 -- sh    # ouverture d&#39;une session shell sur le pod vault-0
vault login hvs.G145zNl012ApNOap3sn2zhIG   # login à Vault avec le token root

vault write auth/kubernetes/config kubernetes_host=https://${KUBERNETES_SERVICE_HOST}:${KUBERNETES_SERVICE_PORT}
vault read auth/kubernetes/config
exit
</code></pre></div>
<p>Vault est désormais configuré pour permettre à notre cluster Kubernetes de s'y authentifier.
Les pods utiliseront leur propre (short-lived) token JWT, raison pour laquelle nous n'avons pas précisé dans la dernière commande les paramètres <em>token_reviewer_jwt</em> et <em>kubernetes_ca_cert</em>.</p>
<h2 id="deploiement-de-lapplication-silly-webapp">Déploiement de l'application 'silly-webapp'</h2>
<p>Nous prendrons comme exemple le déploiement d'une appli 'custom' qui affichera des secrets dans une page web. Le Helm Chart attend que nous renseignions les variables suivantes :</p>
<div class="language-text highlight"><pre><span></span><code>BGCOLOR:  DarkOliveGreen
COLOR:    PaleGreen
LOGIN:    admin
PASSWORD: m%K@W5JeVyQ4jik2@#Lv3fV@D7PGPv
</code></pre></div>
<p>Nous prévoyons de définir un service account nommé 'silly-webapp', de déployer l'application dans un namespace également nommé 'silly-webapp'.
Mais commençons par préparer Vault à héberger et délivrer les secrets à l'application.</p>
<h3 id="operations-sur-vault">Opérations sur Vault</h3>
<p>Nous utiliserons le KVv2 engine (moteur de clés/valeurs).</p>
<div class="language-text highlight"><pre><span></span><code># Login avec le root token sur Vault (dans le pod vault-0) :
kubectl -n vault exec -it vault-0 -- sh    # ouverture d&#39;une session shell sur le pod vault-0
vault login hvs.G145zNl012ApNOap3sn2zhIG   # login à Vault avec le token root

# Activation de KVv2 secrets engine :
vault secrets enable -version=2 kv
vault secrets list

# Ecriture des secrets dans le path /kv/silly-webapp :
vault kv put -mount=kv silly-webapp \
  BGCOLOR=DarkOliveGreen \
  COLOR=PaleGreen \
  LOGIN=admin \
  PASSWORD=m%K@W5JeVyQ4jik2@#Lv3fV@D7PGPv
vault kv get -mount kv silly-webapp

# Ecriture d&#39;une policy d&#39;accès en lecture sur le path /kv/silly-webapp :
vault policy write kv-silly-webapp-read - &lt;&lt; EOF
path &quot;kv/metadata/silly-webapp&quot; {
  capabilities = [&quot;list&quot;,&quot;read&quot;]
}
path &quot;kv/data/silly-webapp&quot; {
  capabilities = [&quot;list&quot;,&quot;read&quot;]
}
EOF
vault policy read kv-silly-webapp-read

# Fin de session
exit

# Définition d&#39;un rôle autorisant le service-account &#39;silly-webapp&#39; du namespace &#39;silly-webapp&#39; de lire les secrets précédents dans Vault :
vault write auth/kubernetes/role/silly-webapp \
    bound_service_account_names=silly-webapp \
    bound_service_account_namespaces=silly-webapp \
    policies=kv-silly-webapp-read \
    ttl=1h
vault read auth/kubernetes/role/silly-webapp
</code></pre></div>
<h3 id="creation-du-helm-chart-pour-lapplication-silly-webapp">Création du Helm Chart pour l'application 'silly-webapp'</h3>
<h4 id="lapplication-en-question">L'application en question</h4>
<h5 id="creation-manuelle">Création 'manuelle'</h5>
<p>Notre application sera très simple : un serveur web Apache qui affiche une page web contenant nos secrets protégés dans Vault.</p>
<p>Pour ce faire, nous devrons créer :
* 1 namespace dédié;
* 1 service account;
* 1 ClusterRoleBinding affectant au service account le ClusterRole qui permette à Kubernetes de déléguer les contrôles d'authentification et d'autorisation à l'application (cf. doc : https://kubernetes.io/docs/reference/access-authn-authz/rbac/#other-component-roles)
* 1 Deployment qui lancera 1 pod avec pour image Apache 2.4;
* 1 SecretStore ouvrant l'accès à Vault au service account de l'application;
* 1 ExternalSecret qui génèrera la page web affichée par l'application avec les secrets récupérés depuis Vault;
* 1 service pour exposer l'application.</p>
<p>Les manifests YAML se trouvent dans le répertoire ./silly-webapp/manifests</p>
<p>Testons l'application en la déployant à la main : </p>
<div class="language-text highlight"><pre><span></span><code>cd silly-webapp/manifests
kubectl apply -f namespace.yaml
kubectl apply -f serviceaccount.yaml
kubectl apply -f clusterrolebinding.yaml
kubectl apply -f secretstore.yaml
kubectl apply -f externalsecret.yaml
kubectl apply -f deployment.yaml
kubectl apply -f service.yaml

kubectl port-forward service/silly-webapp 8080:80
curl http://localhost:8080 
&lt;table border=1 style=&quot;background-color:DarkOliveGreen;color:PaleGreen&quot;
  &lt;tr&gt;
    &lt;th&gt;SECRET&lt;/th&gt;
    &lt;th&gt;VALUE&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;BGCOLOR&lt;/td&gt;
    &lt;td&gt;DarkOliveGreen&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;COLOR&lt;/td&gt;
    &lt;td&gt;PaleGreen&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;LOGIN&lt;/td&gt;
    &lt;td&gt;admin&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;PASSWORD&lt;/td&gt;
    &lt;td&gt;m%K@W5JeVyQ4jik2@#Lv3fV@D7PGPv&lt;/td&gt;
  &lt;tr&gt;
&lt;/table&gt;
</code></pre></div>
<p>Top, ça marche !
Faison le ménage.</p>
<div class="language-text highlight"><pre><span></span><code>kubectl delete ns silly-webapp
kubectl get clusterrolebinding external-secret-silly-webapp
</code></pre></div>
<h5 id="packaging-de-lapplication-avec-helm">Packaging de l'application avec Helm</h5>
<p>Sortons du répertoire contenant les manifests :</p>
<div class="language-text highlight"><pre><span></span><code>cd ...
pwd
</code></pre></div>
<p>Nous allons créer un Helm Chart from scratch :</p>
<div class="language-text highlight"><pre><span></span><code># Création d&#39;un Helm Chart par défaut 
helm create silly-webapp

# Remplacement des templates par les manifests YAML que nous venons de produire :
rm -rf silly-webapp/templates/*.yaml
cp manifests/*.yaml silly-webapp/templates/.
helm instal silly-webapp ./silly-webapp --dry-run


    silly-webapp
    ├── Chart.yaml
    ├── charts
    ├── templates
    │   ├── clusterrolebinding.yaml
    │   ├── deployment.yaml
    │   ├── externalsecret.yaml
    │   ├── namespace.yaml
    │   ├── secret.yaml
    │   ├── secretstore.yaml
    │   ├── service.yaml
    │   ├── serviceaccount.yaml
    │   └── tests
    │       └── test-connection.yaml
    └── values.yaml
</code></pre></div>
<p>Le Helm Chart fonctionnera en l'état. Mais il est plus intéressant de 'templatiser' les manifests si l'on souhaite pouvoir créer des Helm releases différentes à partir du même Helm chart.
Cette partie sort du périmètre de cete doc. Je laisse les manifests originaux dans le répertoire 'manifests' et le Helm chart 'templatisé' dans le répertoire 'silly-webapp', pour comparer l'avant et l'après.</p>
<p>TODO : 
Expliquer comment on passe des manifests 'manuels' à des templates variabilisés Helm.
Détailler la particularité de Helm avec External Secrets (lequel des 2 doit interpréter les variables et comment).</p>
<p>Ensuite :</p>
<div class="language-text highlight"><pre><span></span><code>helm install silly-webapp ./silly-webapp --create-namespace
helm test silly-webapp -n silly-webapp

helm package ./silly-webapp
Successfully packaged chart and saved it to: (...)/silly-webapp-0.1.0.tgz
</code></pre></div>
<h2 id="creation-dun-repository-de-helm-charts-avec-github-et-github-actions">Création d'un repository de Helm Charts avec GitHub et GitHub Actions</h2>
<p>Maintenant que nous avons créé notre Helm Chart, nous allons le publier pour pouvoir le rendre utilisable autrement qu'en local.</p>
<h3 id="creation-dun-github-repository-dedie-a-nos-helm-harts">Création d'un GitHub Repository dédié à nos Helm harts</h3>
<p>Une fois logué sur le site GitHub, créer un nouveau repository :
* name : papafrancky/helm-charts
* accessibility : public</p>
<p>Nous allons placer les Helm Charts sous la forme de manifests dans un répertoire 'charts', et ces mêmes charts packagés en .tgz dans un répertoire 'packages'.
La page d'index du repo Helm (index.yaml) se trouvera donc dans le répertoire 'packages' et sera accessible à l'adresse suivante : </p>
<div class="language-text highlight"><pre><span></span><code>https://raw.githubusercontent.com/papafrancky/helm-charts/main/packages/index.yaml
</code></pre></div>
<p>Nous préciserons cela dans le README du repository.</p>
<div class="language-text highlight"><pre><span></span><code>mkdir ~/code/github/helm-charts
cd ~/code/github/helm-charts
mkdir charts templates
touch charts/.gitkeep packages/.gitkeep

printf &quot;# Papa Francky&#39;s Helm Charts Repository\n\nTo add the papaFrancky Helm repository :\n\n    helm repo add papafrancky https://raw.githubusercontent.com/papafrancky/helm-charts/main/packages\n\nTo upgrade an existing installation :\n\n    helm repo upgrade papafrancky\n\nTo search for stable release versons matching the keyword &quot;papafrancky&quot; :\n\n    helm search repo papafrancky\n&quot; &gt; README.md
</code></pre></div>
<h3 id="la-github-action">La GitHub Action</h3>
<div class="language-text highlight"><pre><span></span><code>cd ~/code/github/helm-charts
mkdir -p .github/{workflows,scripts}

cat &lt;&lt; EOF &gt;&gt; .github/workflows/helmchart_release.yml
name: Helm Chart Release

on:
  push:
    branches: [ &quot;main&quot; ]
    paths: [ &#39;charts/**&#39; ]
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  helm_repo_update:
    runs-on: ubuntu-latest
    steps:

      - uses: actions/checkout@v3

      - name: Helm tool installer
        uses: Azure/setup-helm@v4
        with:
          version: latest

      - name: Helm packaging and reposotiry indexing
        run: ./.github/scripts/helm_packaging_and_repo_indexing.sh

      - name: GIT Commit and Push
        run: |
          cd ${GITHUB_WORKSPACE}
          git config user.name &quot;${GITHUB_ACTOR}&quot;
          git config user.email &quot;${GITHUB_ACTOR}@users.noreply.github.com&quot;
          git add .
          git commit -a -m &quot;Helm packages publication is up-to-date.&quot;
          git push
EOF

vi .github/scripts/helm_packaging_and_repo_indexing.sh

  #!/bin/sh

  HelmChartsDir=&quot;${GITHUB_WORKSPACE}/charts&quot;       # Helm Charts Directory (files)
  HelmPackagesDir=&quot;${GITHUB_WORKSPACE}/packages&quot;   # Helm packaged Charts (.tgz)

  # Package Helm Charts
  ChartsList=$( find ${HelmChartsDir} -type d -maxdepth 1 | grep -v charts$ )
  printf &quot;Packaging the Helm charts ...\n&quot;
  for Chart in $( echo ${ChartsList} ); do
    helm package ${Chart} --destination ${HelmPackagesDir}
  done

  # Repo Index
  printf &quot;Indexing the Helm charts ...\n&quot;
  helm repo index ${HelmPackagesDir}

chmod +x .github/scripts/helm_packaging_and_repo_indexing.sh
</code></pre></div>
<p>Notre GitHub Action va récupérer le contenu de notre repo sur le runner, installer Helm, packager les Charts en fichiers .tgz et créer un helm repository index.
Pour intégrer les nouveaux fichiers créés à notre code, la GitHub Action devra les pousser sur notre repo de code.
Nous devons modifier les paramètres de notre repo pour autoriser les GitHub Actions à écrire :</p>
<p>https://github.com/papafrancky/helm-charts/settings/actions
-&gt; Workflow permissions : Read and write permissions </p>
<div class="language-text highlight"><pre><span></span><code>git init
git add .
git commit -m &quot;first commit&quot;
git branch -M main
git remote add origin git@github.com:papafrancky/helm-charts.git
git push -u origin main
</code></pre></div>
<h3 id="copie-de-notre-helm-chart-silly-webapp-dans-notre-helm-repo">Copie de notre Helm Chart 'silly-webapp' dans notre Helm repo</h3>
<div class="language-text highlight"><pre><span></span><code>cp -r ../../tmp/protect_secrets_using_Vault_and_External_Secrets_Operator/silly-webapp/silly-webapp charts
tree
    .
    ├── README.md
    ├── charts
    │   └── silly-webapp
    │       ├── Chart.yaml
    │       ├── charts
    │       ├── templates
    │       │   ├── NOTES.txt
    │       │   ├── clusterrolebinding.yaml
    │       │   ├── deployment.yaml
    │       │   ├── externalsecret.yaml
    │       │   ├── secretstore.yaml
    │       │   ├── service.yaml
    │       │   ├── serviceaccount.yaml
    │       │   └── tests
    │       │       └── test-connection.yaml
    │       └── values.yaml
    └── packages

git add .
git commit -m &#39;added silly-webapp helm chart.&#39;
git push

-&gt; la GitHub Action s&#39;exécute, créé le package silly-webapp-0.1.0.tgz, met l&#39;index à jour.
git pull
tree
  .
  ├── README.md
  ├── charts
  │   └── silly-webapp
  │       ├── Chart.yaml
  │       ├── charts
  │       ├── templates
  │       │   ├── NOTES.txt
  │       │   ├── clusterrolebinding.yaml
  │       │   ├── deployment.yaml
  │       │   ├── externalsecret.yaml
  │       │   ├── secretstore.yaml
  │       │   ├── service.yaml
  │       │   ├── serviceaccount.yaml
  │       │   └── tests
  │       │       └── test-connection.yaml
  │       └── values.yaml
  └── packages
      ├── index.yaml
      └── silly-webapp-0.1.0.tgz

cat packages/index.yaml

    apiVersion: v1
    entries:
      silly-webapp:
      - apiVersion: v2
        appVersion: &quot;2.4&quot;
        created: &quot;2024-03-14T20:10:32.534365859Z&quot;
        description: A simple web application exposing credentials retrieved from a Vault
          instance through the External Secrets Operator (ESO).
        digest: 95e29f48321a31eee8793ccc94a0da08dad9ddc7bd36fb6730f8f30e0bb59de8
        name: silly-webapp
        type: application
        urls:
        - silly-webapp-0.1.0.tgz
        version: 0.1.0
    generated: &quot;2024-03-14T20:10:32.53390382Z&quot;
</code></pre></div>
<h3 id="utilisation-de-notre-helm-repo">Utilisation de notre Helm repo</h3>
<p>Pour cela, rien de plus simple, il suffit de suivre les indications dans le README.md :</p>
<div class="language-text highlight"><pre><span></span><code>helm repo add papafrancky https://raw.githubusercontent.com/papafrancky/helm-charts/main/packages
helm search repo papafrancky

    NAME                        CHART VERSION   APP VERSION DESCRIPTION
    papafrancky/silly-webapp    0.1.0           2.4         A simple web application exposing credentials r...


helm test silly-webapp

    NAME: silly-webapp
    LAST DEPLOYED: Mon Mar 11 21:31:21 2024
    NAMESPACE: silly-webapp
    STATUS: deployed
    REVISION: 1
    TEST SUITE:     silly-webapp-test-connection
    Last Started:   Sat Mar 16 11:15:43 2024
    Last Completed: Sat Mar 16 11:15:46 2024
    Phase:          Succeeded
    NOTES:
    &#39;silly-webapp&#39; really is... a silly webapp : it consists in a simple Apache 2.4 webserver exposing a webpage     which     contains credentials retrieved from Vault through the &#39;External Secrets Operator (ESO)&#39;.

    To see it in action :

        kubectl --namespace silly-webapp port-forward service/silly-webapp 8080:80
        Visit http://127.0.0.1:8080 to see the secrets.
</code></pre></div>
<p>L'application est correctement déployée et fonctionne comme attendu.
Nous pouvons désormais la confier à FluxCD.</p>
<p>Commençons par faire du ménage :</p>
<div class="language-text highlight"><pre><span></span><code>kubectl delete ns silly-webapp
</code></pre></div>
<h3 id="gestion-de-silly-webapp-par-fluxcd">Gestion de 'silly-webapp' par FluxCD</h3>
<h4 id="alerting-discord_1">alerting Discord</h4>
<h5 id="creation-du-salon-prive-sur-le-client-discord_1">création du salon privé sur le client Discord</h5>
<p>Création d'un nouveau salon (privé) : 
  - nom : silly-webapp-development
  - webhook :
    - nom : FluxCD
    - URL : https://discord.com/api/webhooks/1218504455075401788/2NJmyKGT86cz6dC18-o3D2B9d4dT69OUzLLtnHZZqIiZeUP4zHfNxxV-b8UBKQVXGicM</p>
<h5 id="on-place-le-webhook-du-salon-discord-dans-un-secret-kubernetes_1">on place le webhook du salon discord dans un secret kubernetes</h5>
<div class="language-text highlight"><pre><span></span><code># Travaillons sur la copie locale du repo git de notre cluster de développement
cd ~/code/github/kubernetes-development
git pull
mkdir products/silly-webapp

# Création du namespace de l&#39;application :
kubectl create ns silly-webapp --dry-run=client -o yaml | grep -vE &quot;creationTimestamp|spec|status&quot; &gt; products/silly-webapp/namespace.yaml
kubectl apply -f products/silly-webapp/namespace.yaml

# Création du secret contenant le webhook du salon Discord :
DISCORD_WEBHOOK=&quot;https://discord.com/api/webhooks/1218504455075401788/2NJmyKGT86cz6dC18-o3D2B9d4dT69OUzLLtnHZZqIiZeUP4zHfNxxV-b8UBKQVXGicM&quot;
kubectl -n silly-webapp create secret generic discord-webhook --from-literal=address=${DISCORD_WEBHOOK} --dry-run=client -o yaml &gt; products/silly-webapp/discord-webhook.secret.yaml
</code></pre></div>
<h5 id="definition-de-lalert-provider-discord_1">définition de l'alert-provider Discord</h5>
<div class="language-text highlight"><pre><span></span><code>flux create alert-provider discord \
  --type=discord \
  --secret-ref=discord-webhook \
  --channel=silly-webapp-development \
  --username=FluxCD \
  --namespace=silly-webapp \
  --export &gt; products/silly-webapp/notification-provider.yaml
</code></pre></div>
<h5 id="configuration-des-alertes-discord_1">configuration des alertes Discord</h5>
<div class="language-text highlight"><pre><span></span><code>flux create alert discord \
  --event-severity=info \
  --event-source=&#39;GitRepository/*,Kustomization/*,ImageRepository/*,ImagePolicy/*,HelmRepository/*,HelmRelease/*&#39; \
  --provider-ref=discord \
  --namespace=silly-webapp \
  --export &gt; products/silly-webapp/notification-alert.yaml
</code></pre></div>
<h5 id="poussons-les-manifests-sur-le-repo-central-pour-que-fluxcd-les-gere_1">Poussons les manifests sur le repo central pour que FluxCD les gère :</h5>
<div class="language-text highlight"><pre><span></span><code>git add products/silly-webapp
git commit -m &#39;feat: configuring discord alerting for silly-webapp.&#39;
git push

flux reconcile kustomization flux-system --with-source
flux events -w
</code></pre></div>
<h4 id="gestion-du-repo-helm_1">Gestion du repo Helm</h4>
<div class="language-text highlight"><pre><span></span><code>flux create source helm papafrancky \
  --url=https://raw.githubusercontent.com/papafrancky/helm-charts/main/packages \
  --namespace=silly-webapp \
  --interval=1m \
  --export &gt; products/silly-webapp/helm-repository.yml
</code></pre></div>
<h4 id="deploiement-de-silly-webapp-helm-release">Déploiement de silly-webapp (helm release)</h4>
<p>Nous installerons l'application avec les paramètres par défaut, raison pour laquelle le paramètre --values est commenté.</p>
<div class="language-text highlight"><pre><span></span><code>flux create helmrelease silly-webapp \
  --source=HelmRepository/papafrancky \
  --chart=silly-webapp \
  #--values=products/silly-webapp/custom-values.txt \
  --namespace=silly-webapp \
  --export &gt; products/silly-webapp/helm-release.yaml


git status
git add products/silly-webapp
git commit -m &#39;feat: managing silly-webapp helm deployment.&#39;
git push

flux reconcile kustomization flux-system --with-source
flux events -w
helm test silly-webapp
kubectl --namespace silly-webapp port-forward service/silly-webapp 8080:80
</code></pre></div>
<p>Tout fonctionne comme attendu ! ^^</p>
<h2 id="protection-de-webhook-utilise-pour-la-notification-discord">Protection de webhook utilisé pour la notification Discord</h2>
<p>Si on regarde bien, nous avons 1 secret qui n'est pas 'protégé' dans Vault : discord-webhook (le webhook utilisé pour nos notifications Discord)</p>
<p>Commençons par créer insérer ce secret dans Vault.</p>
<h3 id="ajout-du-webhook-dans-vault">Ajout du webhook dans Vault</h3>
<div class="language-text highlight"><pre><span></span><code># Login avec le root token sur Vault (dans le pod vault-0) :
kubectl -n vault exec -it vault-0 -- sh    # ouverture d&#39;une session shell sur le pod vault-0
vault login hvs.G145zNl012ApNOap3sn2zhIG   # login à Vault avec le token root

# Ecriture des secrets dans le path /kv/silly-webapp/discord-notifications :
vault kv put -mount=kv silly-webapp/discord-notifications \
  WEBHOOK=https://discord.com/api/webhooks/1218504455075401788/2NJmyKGT86cz6dC18-o3D2B9d4dT69OUzLLtnHZZqIiZeUP4zHfNxxV-b8UBKQVXGicM
vault kv get -mount kv silly-webapp/discord-notifications
</code></pre></div>
<h3 id="modification-de-la-vault-policy-pour-silly-webapp">Modification de la Vault policy pour silly-webapp</h3>
<div class="language-text highlight"><pre><span></span><code># Nous devons modifier la policy d&#39;accès en lecture sur le path /kv/silly-webapp qui était trop restrictive :
vault policy write kv-silly-webapp-read - &lt;&lt; EOF
path &quot;kv/metadata/silly-webapp&quot; {
  capabilities = [&quot;list&quot;,&quot;read&quot;]
}
path &quot;kv/data/silly-webapp&quot; {
  capabilities = [&quot;list&quot;,&quot;read&quot;]
}
path &quot;kv/metadata/silly-webapp/*&quot; {
  capabilities = [&quot;list&quot;,&quot;read&quot;]
}
path &quot;kv/data/silly-webapp/*&quot; {
  capabilities = [&quot;list&quot;,&quot;read&quot;]
}    
EOF

vault policy read kv-silly-webapp-read

# Fin de session
exit


cat &lt;&lt; EOF &gt;&gt; products/silly-webapp/discord-webhook.externalsecret.yaml
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: discord-webhook
  namespace: silly-webapp
spec:
  secretStoreRef:
    name: vault
    kind: SecretStore
  target:
    name: discord-webhook
  data:
  - secretKey: discord-webhook
    remoteRef:
      key: silly-webapp/discord-notifications
      property: WEBHOOK
EOF

k delete secret discord-silly-webapp-development-webhook
rm -f products/silly-webapp/discord-webhook.secret.yaml
</code></pre></div>
<p>Pour tester : </p>
<div class="language-text highlight"><pre><span></span><code>helm uninstall silly-webapp
</code></pre></div>
<p>-&gt; Si lors du reconcile on est alerté par Discord que le Helm Release sille-webapp est réinstallée, tout aura bien marché.</p>
<div class="language-text highlight"><pre><span></span><code>k get externalsecret,secret

    NAME                                                 STORE   REFRESH INTERVAL   STATUS         READY
    externalsecret.external-secrets.io/discord-webhook   vault   1h0m0s             SecretSynced   True
    externalsecret.external-secrets.io/webindex          vault   1h                 SecretSynced   True

    NAME                                              TYPE                 DATA   AGE
    secret/discord-silly-webapp-development-webhook   Opaque               1      2m38s
    secret/discord-webhook                            Opaque               1      35m
    secret/sh.helm.release.v1.silly-webapp.v1         helm.sh/release.v1   1      2m24s
    secret/webindex                                   Opaque               1      2m24s
</code></pre></div>
<p>L'external secret 'discord-webhook' aura créé un secret 'discord-webhook'.
Vérifions qu'il correspond bien à notre webhook :</p>
<div class="language-text highlight"><pre><span></span><code>k get secret discord-webhook -o yaml | yq .data | awk &#39;{print $2}&#39; | base64 -d

    https://discord.com/api/webhooks/1218504455075401788/2NJmyKGT86cz6dC18-o3D2B9d4dT69OUzLLtnHZZqIiZeUP4zHfNxxV-b8UBKQVXGicM%
</code></pre></div>
<p>C'est bon ^^</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>